# Leverage the NavarroComputing functions
. ../../cmd.env

# Ensure logs directory exists
logsDirValidate() { 
    if [ ! -d logs ] ; then
        mkdir logs
        echo "Created logs directory." 
    fi
    return $?
}

# Image versions
export backendVersion=1.3
export frontendVersion=1.3
export mongoVersion=0.3
export websiteVersion=0.2

imagesDanglingRemove() {
    msg INFO "Remove any dangling images ..."
    danglingImageList="$(docker images -aq -f 'dangling=true')"
    if [ -n "$danglingImageList" ] ; then
        docker rmi $(docker images -aq -f 'dangling=true')
    else
        msg INFO "    No dangling images to remove ..."
    fi
}

msg INFO "Determine if we are running on Docker Toolbox or Linux ..."
if [ ! -z "$DOCKER_MACHINE_NAME" ] ; then
    msg INFO "... We are running in Docker Toolbox ..."
    export SDB_HOST_IP="$(docker-machine ip)"
    export TSSGAPIURL="http://backend.sdb"
    export TSSGAPIPORT="80"
    export TSSGAPPURL="http://frontend.sdb"
elif [ "$(hostname)" == "Ubuntu-Studio-14" ] ; then
    msg INFO "... We are running in a Linux server ..."
    export SDB_HOST_IP="$(hostname -I | awk '{print $1}')"
    export TSSGAPIURL="https://backend.sdb.technologynursery.org"
    export TSSGAPIPORT="443"
    export TSSGAPPURL="https://frontend.sdb.technologynursery.org"
else
    msg INFO "... We are running in a local Linux ..."
    export SDB_HOST_IP="$(hostname -I | awk '{print $1}')"
    export TSSGAPIURL="http://backend.sdb"
    export TSSGAPIPORT="80"
    export TSSGAPPURL="http://frontend.sdb"
fi

# get mongo connection url
# connection string format: mongodb://[username:password@]host1[:port1][,...hostN[:portN]][/[defaultauthdb][?options]]
export MONGO_URL="mongodb://root:sch3dul3db@mongo:27017/tssg-tech?authSource=admin"

# get backend url and port
export BACKEND_BASE_URL="http://backend"
export BACKEND_BASE_PORT="7010"

# get website url and port
export WEBSITE_URL="http://website"
export WEBSITE_PORT="8088"

# get frontend url and port
export FRONTEND_URL="http://frontend"
export FRONTEND_PORT="4200"

# get miscellaneous environment variables
# BACKEND_MEETING_DEBUG enables/disables additional meeting setup debug code (output appeaars in backend log)
export BACKEND_MEETING_DEBUG="false"
# BACKEND_DEFAULT_TEAM delclares a default team for the meetings/webSchedule/ route
# any valid team name can be used. It can also be set to "default" and the code will force it to "WedGenMtg".
export BACKEND_DEFAULT_TEAM="WedGenMtg"
# BACKEND_ACCESS_JWT sets the access jwt validity length in MINUTES.
# set BACKEND_ACCESS_JWT >= 1 and <= 30 or backend code will force it to default value.
export BACKEND_ACCESS_JWT="15"
# BACKEND_REFRESH_JWT sets the refresh jwt validity length in MINUTES.
# set BACKEND_REFRESH_JWT > BACKEND_ACCESS_JWT and <= 240 or backend code will force it to default value.
export BACKEND_REFRESH_JWT="120'
